# 1.阿里百秀需求分析
 
 - 前台：
  - 首页:   信息聚合页面，各种方式显示文章列表
  - 列表页: 显示某个栏目下的所有文章列表
  - 详情页: 显示文章的详细内容 
- 后台：
  - 管理员登录、退出功能
  - 文章管理：文章的增删改查
  - 栏目管理：栏目的增删改查
  - 用户管理：用户的增删改
  - 评论管理：批准/驳回评论
  - 设置：图片轮播、网站设置等。

# 2. **项目结构搭建**
  
    目标： 将阿里百秀的静态网页变为静态网站。

    方法： 使用express创建服务器，并显示前台首页，后台首页，后台登录页三个页面

  - view： 页面文件目录，包括：html、js、css、第三方插件、图片等
  - app.js： 服务器文件，用来创建并开启服务器，加载第三方模块，托管静态资源，加载路由模块
  - router.js： 路由模块
  - db.js： 数据库操作模块

  - node_modules： 第三方模块目录
  - package.json： 项目描述文件
  - package-lock.json： 第三方包描述文件

##  2.1 **安装项目所需包**

```shell
npm init -y
npm i express art-template express-art-template express-session mysql multer moment
```
## 2.2 创建view目录
   index.html: 前台首页

   list.html:  前台栏目列表页

   detail.html: 文章详情页

   assets: 静态资源目录

   css: 保存项目使用的css文件

   img: 保存项目使用的图片

   vendors: 保存第三方插件的目录



  uploads: 上传文件的保存目录

  admin： 后台管理页面

#  大概作法
 
##  1 **创建服务器** --- app.js --> 能开启服务器
  
##  2 先把静态页面,先用render方法挂起来  --> 能正常显示页面

##  3 配置中间键,把所需的静态资源加载进来!  --> 要求能把所有需的资源加载好

##  4 先找出那些是公共的html结构, 使用模板继承 -->要求能显示页面

##  5 创建db.js模块

##  6 使用mysql/mongose 查询数据库

##  7 动态渲染首页等其他页面

##  8 增删改查的操作

##  9 设置登录session / 路由拆分

    前端路由/后端路由
-----------------------------------------------

## 2.6 抽取页面公共部分
- 问题：后台页面中有几个部分是重复的，每个页面都有。这样写法有一个最大的缺点就是一旦页面要发生改变，每个页面的代码都需要进行修改。
- 解决方案：art-template模板引擎有一个功能叫做模板继承，能够解决该问题。
- 模板集成就是子模板继承父模板的结构，然后在子模板中实现各自的页面效果

解决方案：  模板继承

1) 找出所有的页面的公共部分

2) 创建模板页面，公共部分保留。每页页面不同的部分挖坑留名

3) 子页面继承父页面结构，在留名的地方填写自己的代码


# 3. **栏目管理模块实现**
目标: 通过网页对ali_cate表进行增删改查操作

思路分析：

- 1) 创建 /admin/cate/cate 路由，正常显示页面
- 2) 在cate.html页面发送Ajax请求，请求后台获取栏目数据的路由（/admin/cate/getCate）

- 3) 创建 /admin/cate/getCate路由
  - ① 编写查询栏目信息的SQL语句
  - ② 执行SQL语句
  - ③ 将结果返回给前端页面（cate.html） 
- 4) 前端页面（cate.html）使用模板引擎显示结果


模板引擎核心点： 在cate.html页面中重新定义模板的边界符

- 原始语法的界定符规则

      template.defaults.rules[0].test = /<%(#?)((?:==|=#|[=-])?)[ \t]*([\w\W]*?)[ \t]*(-?)%>/;

- 标准语法的界定符规则

      template.defaults.rules[1].test = /{{([@#]?)[ \t]*(\/?)([\w\W]*?)[ \t]*}}/;

# 4. **添加模块实现**
目标: 通过form 表单添加数据到数据库

思路分析:
  1) 显示静态添加页面, 确认form表单正确可以 使用post 提交 地址:(/admin/cate/addCatePost)

  2)创建 /admin/cate/addCatePost 路由
    - ① 编写查询栏目信息的SQL语句
    - ② 执行SQL语句
    - ③  返回给前端页面（'<script>alert('提交成功!');loca....re...</script>'）


## 登录 + 退出登录

## 6/23  个人信息展示  /admin/center/profile
  1.先把页面展示出来

  2.把session携带的用户信息展示到,页面上
    1.头像图片 放在 unload文件夹里. 还没有挂载静态

  3.个人信息 头像上传
    1.使用的是 formData  把找到上传的图片对象  append 到 空 new formData里面  注意append后 是传fd
    2.上传有后端的地址了
    3.使用 change的事件 
    4.要把新的地址保留在新的 input里

  4.更新问题出现了  不应该从登陆哪里获取

##  2.4 修改密码

实现思路：

1) 在修改按钮上注册点击事件

2) 点击事件函数
      使用 validate 验证表单
- ① 获取表单数据
- ② 发送Ajax请求  （已提供接口，自行查阅文档）
- ③ 接收请求结果提示成功/失败

## 4.2 添加新文章

  思路分析：

  1) 正常显示文章添加页

- ① 文章内容区域使用Ueditor插件改造为富文本编辑器
- ② 栏目下拉菜单要读取ali_cate数据表的数据
- ③ 封面图片要使用Ajax文件上传 
  - i. 在文件域上注册onchange事件
  - ii. 获取文件对象 --- FormData
  - iii. 发送ajax请求，并将文件对象一起发送给后端 
  2) 保存按钮注册点击事件，获取表单数据，发送Ajax请求
  3) 接收后端返回结果，提示成功/失败

# 每日目标： 6-24

- 分页技术完成文章列表
      使用插件 
        1.引入插件的主要文件
        2.在容器里面显示
        3.页面数根据接口来配置 api:
        4.发送ajax
- 能够利用数据接口完成轮播图列表功能
      发送ajax后
- 能够利用数据接口完成添加新轮播图功能
- 前台首页数据显示


#添加轮播图片到数据库

1)先把图片添加到数据库

## 显示首页

1.是通过后端渲染的  - 写后台查询数据库  -- 公共部分提取  -- 通过模板渲染数据


